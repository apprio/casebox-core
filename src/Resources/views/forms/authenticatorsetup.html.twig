{% extends 'CaseboxCoreBundle::login.html.twig' %}

{% block form %}
    <script type="text/javascript">
        //<--
        String.prototype.trim = function () {
            return this.replace(/^\s+|\s+$/g, "");
        };
        function editChanged() {
            s = document.getElementById('s');
            s.disabled = (document.getElementById('c').value.trim() == '');
            if (s.disabled)
                setTimeout(editChanged, 500)
        }
        //-->
    </script>

    <form method="post" action="/c/{{ coreName }}/login/2stepsetup" class="standart_form tal" autocomplete="off">
        <label>Two Factor Authentication Setup</label>
Scan following Barcode to register the application automatically:<br />
<div class="taC p10" style="text-align:center">
<img alt="Two Factor Barcode"  src="{{url}}" width="100" height="100" />
</div>
<p> Or enter the following secret key into the Authenticator app to register the application manually:</p>
<div class="taC p10 bgcY">
 <div class="fs14 fwB" dir="ltr">{{sd}}</div>
<div class="fs10 cG">Spaces don't matter.
<br/> If registering manually, <b>do not enter the above key directly into the "Enter code" field below</b>. Enter the above key into Authenticator along with your username.</div>
</div><br />
<p> Once you have manually entered and saved your key, enter the 6-digit verification code generated by the Authenticator app into the field below. </p>
</tpl>
        <label>
            <input type="text" name="c" id="c" placeholder="{{ 'EnterCode'|trans }}">
            {% for flash_message in app.session.flashbag.get('notice') %}
                <div class="alert alert-error">
                    {{ flash_message }}
                </div>
            {% endfor %}
            <span class="icon-lock"></span>
        </label>
        <input type="submit" name="s" id="s" value="{{ 'Verify'|trans }}" class="btn btn-info" style="margin-top: 26px;" disabled>
    </form>
{% endblock %}
